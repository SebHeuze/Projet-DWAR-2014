function createMarker(e,t,n,r,i){var s="<b>"+n+"</b><br>"+r;var o=new google.maps.Marker({position:t,map:e,shadow:iconShadow,icon:getMarkerImage(i),shape:iconShape,title:n,zIndex:Math.round(t.lat()*-1e5)<<5});o.myname=n;google.maps.event.addListener(o,"click",function(){infowindow.setContent(s);infowindow.open(e,o)});return o}function createTanMarker(e,t,n,r){latlng=new google.maps.LatLng((n.k-t.k)/2+t.k,(n.A-t.A)/2+t.A);var i=new google.maps.Marker({position:latlng,map:e,icon:new google.maps.MarkerImage("https://www.tan.fr/ewp/images/pictos_lignes/"+r+".gif",null,null,null,new google.maps.Size(14,14)),title:"Ligne"});return i}function setDirectionsBus(e,t,n){var r=[];var i=[];var s=[];var o=10;var u=0;var a=e.length>0;var f;while(a){var l=[];var c=0;var f=e[u+1].travelMode;var h=e[u+1].ligne;for(var p=u;p<e.length;p++){if(p!=u&&e[p].travelMode!=f){s.pop();break}c++;l.push({location:new google.maps.LatLng(e[p].latitude,e[p].longitude),stopover:true});s.push(e[p].ligne);if(c==o){s.pop();break}}u+=c;r.push(l);i.push(f);a=u<e.length;u--}var d;var v=[{}];var m=0;for(var g in r){if(i[g]=="BUS"||i[g]=="TRAM"){var y=[];for(var b in r[g]){y.push(r[g][b].location)}var w=new google.maps.Polyline({strokeColor:transitColor,strokeOpacity:.8,path:y,strokeWeight:5,map:map});busPaths.push(w)}}for(var E=0;E<r.length;E++){var S=r[E].length-1;var x=r[E][0].location;var T=r[E][S].location;var N=[];N=r[E];N.splice(0,1);N.splice(N.length-1,1);var C={origin:x,destination:T,waypoints:N,travelMode:google.maps.TravelMode.WALKING};(function(e){directionsService.route(C,function(t,n){if(n==window.google.maps.DirectionsStatus.OK){var o={order:e,result:t};v.push(o);m++;if(m==r.length){v.sort(function(e,t){return parseFloat(e.order)-parseFloat(t.order)});var u=0;for(var a in v){directionsDisplayArray[a-1]=new google.maps.DirectionsRenderer({suppressMarkers:true,polylineOptions:walkPath});directionsDisplayArray[a-1].setMap(map);if(v[a].result!=null){if(v.hasOwnProperty(a)){if(u==0)var f=v[a].result.routes[0].legs;else{f=f.concat(v[a].result.routes[0].legs)}if(i[a-1]=="MARCHE"){directionsDisplayArray[a-1].setDirections(v[a].result)}u++}}}for(var l=0;l<f.length;l++){var c="A".charCodeAt(0);c+=l;c=String.fromCharCode(c);createTanMarker(directionsDisplay1.getMap(),f[l].start_location,f[l].end_location,s[l+1]);createMarker(directionsDisplay1.getMap(),f[l].start_location,"marker"+l,"some text for marker "+l+"<br>"+f[l].start_address,c)}var l=f.length;var c="A".charCodeAt(0);c+=l;c=String.fromCharCode(c);createMarker(directionsDisplay1.getMap(),f[f.length-1].end_location,"marker"+l,"some text for the "+l+"marker<br>"+f[f.length-1].end_address,c)}}})})(E)}}function setDirectionsVoiture(e,t,n,r){var i={origin:t.coord.latitude+", "+t.coord.longitude,destination:n.coord.latitude+", "+n.coord.longitude,optimizeWaypoints:true,travelMode:google.maps.TravelMode.DRIVING};directionsService.route(i,function(e,t){if(t==google.maps.DirectionsStatus.OK){directionsDisplay.setDirections(e)}});createMarker(directionsDisplay.getMap(),new google.maps.LatLng(r.coord.latitude,r.coord.longitude),r.nom,"Cout parking "+r.cout+"<br>","parking")}function getMarkerImage(e){if(typeof e=="undefined"||e==null){e="red"}if(!icons[e]){if(e=="parking"){icons[e]=new google.maps.MarkerImage("http://img1.imagilive.com/0614/parkinggarage.png",new google.maps.Size(32,37),new google.maps.Point(0,0),new google.maps.Point(9,34))}else{icons[e]=new google.maps.MarkerImage("http://www.google.com/mapfiles/marker"+e+".png",new google.maps.Size(20,34),new google.maps.Point(0,0),new google.maps.Point(9,34))}}return icons[e]}function getPuceImageLetter(e){return"http://maps.google.com/mapfiles/kml/paddle/"+e+"-lv.png"}function clone(e){if(null==e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e){if(e.hasOwnProperty(n))t[n]=e[n]}return t}var map;var initialize;var directionsService;var directionsDisplay;var directionsDisplay1;var directionsDisplayArray=[];var iconShadow=new google.maps.MarkerImage("http://www.google.com/mapfiles/shadow50.png");var icons=new Array;var iconShape={coord:[9,0,6,1,4,2,2,4,0,8,0,12,1,14,2,16,5,19,7,23,8,26,9,30,9,34,11,34,11,30,12,26,13,24,14,21,16,18,18,16,20,12,20,8,18,4,16,2,15,1,13,0],type:"poly"};var infowindow=new google.maps.InfoWindow({size:new google.maps.Size(150,50)});icons["red"]=new google.maps.MarkerImage("http://www.geocodezip.com/mapIcons/marker_red.png",new google.maps.Size(20,34),new google.maps.Point(0,0),new google.maps.Point(9,34));var drivingColor="#CC0044";var transitColor="#2BCC3D";initialize=function(){var e=new google.maps.LatLng(47.2173,-1.5534);var t={zoom:14,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:20};map=new google.maps.Map(document.getElementById("map"),t);drivingPath=new google.maps.Polyline({strokeColor:drivingColor,strokeOpacity:.8,strokeWeight:5,map:map});var n={path:"M 0,-1 0,1",strokeOpacity:1,scale:4};walkPath=new google.maps.Polyline({strokeColor:transitColor,strokeOpacity:0,icons:[{icon:n,offset:"0",repeat:"20px"}],strokeWeight:5,map:map});busPaths=[];directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:false,polylineOptions:drivingPath});directionsDisplay.setMap(map);directionsService=new google.maps.DirectionsService;directionsDisplay1=new google.maps.DirectionsRenderer({suppressMarkers:false,polylineOptions:walkPath});directionsDisplay1.setMap(map)};initialize()